<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>11DG11 Â∫´Â≠òÁÆ°ÁêÜ</title>
  <link rel="icon" href="favicon.png">
  <style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&display=swap');

  body {
    margin: 0;
    padding: 0;
    font-family: 'Poppins', sans-serif;
    background: radial-gradient(circle, rgba(255, 191, 221, 0.7), rgba(255, 175, 195, 0.7));
    overflow: auto;
    color: #fff;
    position: relative;
    animation: bgMovement 10s infinite ease-in-out;
  }
  
  @keyframes bgMovement {
    0% { background: radial-gradient(circle, rgba(255, 191, 221, 0.7), rgba(255, 175, 195, 0.7)); }
    50% { background: radial-gradient(circle, rgba(255, 200, 220, 0.8), rgba(255, 160, 180, 0.8)); }
    100% { background: radial-gradient(circle, rgba(255, 191, 221, 0.7), rgba(255, 175, 195, 0.7)); }
  }
  
  body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    pointer-events: none;
    animation: particles 60s linear infinite;
  }
  
  @keyframes particles {
    0% { transform: translate(0, 0); }
    100% { transform: translate(100%, 100%); }
  }
  
  .container {
    max-width: 1000px;
    margin: 60px auto;
    padding: 50px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(40px);
    border-radius: 40px;
    box-shadow: 0 8px 40px rgba(255, 80, 135, 0.2), 0 16px 60px rgba(255, 105, 180, 0.3);
    position: relative;
    z-index: 1;
    animation: fadeIn 1.2s ease-out;
  }
  
  @keyframes fadeIn {
    0% { opacity: 0; transform: translateY(30px); }
    100% { opacity: 1; transform: translateY(0); }
  }
  
  h1 {
    text-align: center;
    font-size: 3.8rem;
    color: #ff4081;
    text-shadow: 0 6px 12px rgba(255, 64, 129, 0.4), 0 0 20px #ff80ab;
    margin-bottom: 60px;
    position: relative;
    animation: titleIn 1.5s ease-out;
  }
  
  @keyframes titleIn {
    0% { opacity: 0; transform: translateY(-40px); }
    100% { opacity: 1; transform: translateY(0); }
  }
  
  h1::after {
    content: '';
    position: absolute;
    top: 110%;
    left: 50%;
    transform: translateX(-50%);
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: 2px solid #ff80ab;
    box-shadow: 0 0 50px rgba(255, 105, 180, 0.5);
    animation: glowRing 2s infinite ease-in-out;
  }
  
  @keyframes glowRing {
    0% { opacity: 0.6; transform: translateX(-50%) scale(0.9); }
    50% { opacity: 1; transform: translateX(-50%) scale(1.2); }
    100% { opacity: 0.6; transform: translateX(-50%) scale(0.9); }
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(255, 105, 180, 0.2);
    animation: tableIn 1s ease-out;
  }
  
  @keyframes tableIn {
    0% { opacity: 0; transform: translateY(40px); }
    100% { opacity: 1; transform: translateY(0); }
  }
  
  th, td {
    padding: 18px 24px;
    text-align: left;
    font-size: 1.1rem;
    color: #fff;
    background: rgba(255, 255, 255, 0.2);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    transition: background 0.3s ease, transform 0.2s ease;
  }
  
  th {
    background: linear-gradient(90deg, #ff80ab, #ffb6c1);
    font-weight: bold;
    text-transform: uppercase;
  }
  
  td input, td select {
    padding: 12px 16px;
    width: 100%;
    border: none;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.5);
    color: #333;
    font-size: 1rem;
    box-shadow: 0 0 15px rgba(255, 105, 180, 0.3);
    transition: background 0.3s ease, box-shadow 0.3s ease;
  }
  
  td input:focus, td select:focus {
    background: rgba(255, 255, 255, 0.7);
    box-shadow: 0 0 25px rgba(255, 105, 180, 0.4);
  }
  
  .action-buttons button {
    padding: 16px 32px;
    border-radius: 50px;
    font-weight: bold;
    font-size: 1.1rem;
    cursor: pointer;
    color: #fff;
    border: none;
    background: linear-gradient(145deg, #ff80ab, #ffb6c1);
    box-shadow: 0 0 25px rgba(255, 105, 180, 0.3);
    transition: transform 0.3s ease, box-shadow 0.4s ease;
    animation: buttonIn 1.5s ease-out;
  }
  
  @keyframes buttonIn {
    0% { opacity: 0; transform: scale(0.8); }
    100% { opacity: 1; transform: scale(1); }
  }
  
  .action-buttons button:hover {
    transform: scale(1.1);
    box-shadow: 0 0 50px rgba(255, 105, 180, 0.5);
  }
  
  .save-btn {
    background: linear-gradient(145deg, #00c9a7, #00e5b2);
  }
  
  .add-btn {
    display: block;
    margin: 70px auto 0;
    padding: 20px 40px;
    font-size: 1.2rem;
    border-radius: 50px;
    font-weight: bold;
    background: linear-gradient(to right, #ff80ab, #ffb6c1);
    color: white;
    box-shadow: 0 0 40px rgba(255, 105, 180, 0.4);
    transition: transform 0.3s ease, box-shadow 0.4s ease;
    animation: addButtonIn 1.5s ease-out;
  }
  
  .delete-btn {
    display: block;
    margin: 20px auto 0;
    padding: 20px 40px;
    font-size: 1.2rem;
    border-radius: 50px;
    font-weight: bold;
    background: linear-gradient(to right, #ff80ab, #ffb6c1);
    color: white;
    box-shadow: 0 0 40px rgba(255, 105, 180, 0.4);
    transition: transform 0.3s ease, box-shadow 0.4s ease;
    animation: addButtonIn 1.5s ease-out;
  }
  
  @keyframes addButtonIn {
    0% { opacity: 0; transform: scale(0.8); }
    100% { opacity: 1; transform: scale(1); }
  }
  
  .add-btn:hover, .delete-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 0 50px rgba(255, 105, 180, 0.5);
  }

  .clear-btn, .delete-all-btn {
  display: block;
  margin: 20px auto;
  padding: 20px 40px;
  font-size: 1.2rem;
  border-radius: 50px;
  font-weight: bold;
  background: linear-gradient(to right, #ff80ab, #ffb6c1);
  color: white;
  box-shadow: 0 0 40px rgba(255, 105, 180, 0.4);
  transition: transform 0.3s ease, box-shadow 0.4s ease;
  animation: addButtonIn 1.5s ease-out;
}

.clear-btn:hover, .delete-all-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 0 50px rgba(255, 105, 180, 0.5);
}

  
  .back-to-home-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(to right, #ec407a, #ba68c8);
    color: #fff;
    padding: 14px 28px;
    font-weight: bold;
    border-radius: 50px;
    box-shadow: 0 0 20px rgba(255, 105, 180, 0.4);
    text-decoration: none;
    transition: transform 0.3s ease;
    animation: backButtonIn 2s ease-out;
  }
  
  @keyframes backButtonIn {
    0% { opacity: 0; transform: scale(0.8); }
    100% { opacity: 1; transform: scale(1); }
  }
  
  .back-to-home-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 0 30px rgba(255, 105, 180, 0.5);
  }
  
  body::after {
    content: '';
    position: absolute;
    top: -10px;
    left: -10px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #ff80ab;
    animation: mouseParticles 0.3s ease-in-out infinite;
  }
  
  @keyframes mouseParticles {
    0% { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(0); }
  }
</style>  
    
  
</head>
<body>
  <div class="container">
    <h1>11DG11 Â∫´Â≠òÁÆ°ÁêÜ</h1>
    <table>
      <thead>
        <tr>
          <th>ÂïÜÂìÅÂêçÁ®±</th>
          <th>ÂÉπÊ†º + Âπ£Âà•</th>
          <th>Â∫´Â≠ò</th>
          <th>Êìç‰Ωú</th>
        </tr>
      </thead>
      <tbody id="productList"></tbody>
    </table>
    <button class="add-btn" onclick="addProduct()">‚ûï Êñ∞Â¢ûÂïÜÂìÅ</button>
    <button class="delete-all-btn" onclick="deleteAllRecords()">üóëÔ∏è Âà™Èô§ÊâÄÊúâË®òÈåÑ</button>
  </div>
  <a href="home.html" class="back-to-home-btn">üè† ËøîÂõû‰∏ªÈ†Å</a>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
    // Èò≤Ê≠¢ÈáçÂ§çÂàùÂßãÂåñÊ£ÄÊü•
    if (typeof firebase === 'undefined') {
      throw new Error('Firebase SDK Êú™Ê≠£Á°ÆÂä†ËΩΩÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•');
    }
  
    // ÂàùÂßãÂåñ FirebaseÔºàÂè™ÂàùÂßãÂåñ‰∏ÄÊ¨°Ôºâ
    if (!firebase.apps.length) {
      const firebaseConfig = {
  apiKey: "AIzaSyCT0Li1XXZ4hZjBTrU8rp1N-ixV5dTrSZQ",
  authDomain: "dg11-c954c.firebaseapp.com",
  projectId: "dg11-c954c",
  storageBucket: "dg11-c954c.firebasestorage.app",
  messagingSenderId: "1010585577335",
  appId: "1:1010585577335:web:ad4f84c5205ba048b22372"
};
      firebase.initializeApp(firebaseConfig);
    }
  
    const db = firebase.firestore();
    const productsCollection = db.collection("products");
    const productList = document.getElementById("productList");
  
    // ÂàõÂª∫Ë°®Ê†ºË°å
    function createRow(doc = null, data = {}) {
      const row = document.createElement("tr");
      row.className = "product-row";
  
      // ÂïÜÂìÅÂêçÁß∞
      const nameCell = document.createElement("td");
      const nameInput = document.createElement("input");
      nameInput.type = "text";
      nameInput.className = "product-name";
      nameInput.value = data.name || "";
      nameCell.appendChild(nameInput);
      row.appendChild(nameCell);
  
      // ‰ª∑Ê†ºÂíåË¥ßÂ∏Å
      const priceCell = document.createElement("td");
      const priceInput = document.createElement("input");
      priceInput.type = "number";
      priceInput.className = "product-price";
      priceInput.value = data.price || "";
      priceInput.min = "0";
      priceInput.step = "0.01";
      priceCell.appendChild(priceInput);
  
      const currencySelect = document.createElement("select");
      currencySelect.className = "product-currency";
      ["ÈüìÂÖÉ", "Âè∞Âπ£", "Êó•ÂÖÉ", "‰∫∫Ê∞ëÂπ£", "ÁæéÂÖÉ"].forEach(currency => {
        const option = document.createElement("option");
        option.value = currency;
        option.textContent = currency;
        if (data.currency === currency) option.selected = true;
        currencySelect.appendChild(option);
      });
      priceCell.appendChild(currencySelect);
      row.appendChild(priceCell);
  
      // Êï∞Èáè
      const quantityCell = document.createElement("td");
      const quantityInput = document.createElement("input");
      quantityInput.type = "number";
      quantityInput.className = "product-quantity";
      quantityInput.value = data.quantity || "";
      quantityInput.min = "0";
      quantityCell.appendChild(quantityInput);
      row.appendChild(quantityCell);
  
      // Êìç‰ΩúÊåâÈíÆ
      const actionCell = document.createElement("td");
      actionCell.className = "action-buttons";
  
      const saveBtn = document.createElement("button");
      saveBtn.className = "btn save-btn";
      saveBtn.textContent = "‰øùÂ≠ò";
      saveBtn.onclick = async () => {
        const productData = {
          name: nameInput.value.trim(),
          price: parseFloat(priceInput.value) || 0,
          currency: currencySelect.value,
          quantity: parseInt(quantityInput.value) || 0,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        };
  
        try {
          if (doc) {
            await productsCollection.doc(doc.id).update(productData);
          } else {
            await productsCollection.add(productData);
          }
          alert("‚úÖ Ë≥áÊñôÂ∑≤‰øùÂ≠ò");
          loadData();
        } catch (error) {
          console.error("‰øùÂ≠òÈîôËØØ:", error);
          alert("‚ùå ‰øùÂ≠òÂ§±Êïó: " + error.message);
        }
      };
  
      const deleteBtn = document.createElement("button");
      deleteBtn.className = "btn delete-btn";
      deleteBtn.textContent = "Âà™Èô§";
      deleteBtn.onclick = async () => {
        if (confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÊ¢ùË®òÈåÑÂóéÔºü")) {
          try {
            if (doc) {
              await productsCollection.doc(doc.id).delete();
            }
            row.remove();
          } catch (error) {
            console.error("Âà†Èô§ÈîôËØØ:", error);
            alert("‚ùå Âà™Èô§Â§±Êïó: " + error.message);
          }
        }
      };
  
      actionCell.appendChild(saveBtn);
      actionCell.appendChild(deleteBtn);
      row.appendChild(actionCell);
  
      productList.appendChild(row);
      return row;
    }
  
    // Ê∑ªÂä†Êñ∞ÂïÜÂìÅ
    function addProduct() {
      createRow();
      window.scrollTo(0, document.body.scrollHeight);
    }
  
    // Âä†ËΩΩÊï∞ÊçÆ
    async function loadData() {
      try {
        const querySnapshot = await productsCollection
          .orderBy("updatedAt", "desc")
          .get();
        
        productList.innerHTML = "";
        querySnapshot.forEach(doc => {
          createRow(doc, doc.data());
        });
      } catch (error) {
        console.error("Âä†ËΩΩÊï∞ÊçÆÈîôËØØ:", error);
        alert("Âä†ËºâÊï∏ÊìöÂ§±Êïó: " + error.message);
      }
    }
  
    // Âà†Èô§ÊâÄÊúâËÆ∞ÂΩï
    async function deleteAllRecords() {
      if (!confirm("‚ö†Ô∏è Á¢∫ÂÆöË¶ÅÂà™Èô§ÊâÄÊúâË®òÈåÑÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÊí§Èä∑ÔºÅ")) return;
      
      try {
        const querySnapshot = await productsCollection.get();
        const batch = db.batch();
        
        querySnapshot.forEach(doc => {
          batch.delete(doc.ref);
        });
        
        await batch.commit();
        alert("‚úÖ ÊâÄÊúâË®òÈåÑÂ∑≤Âà™Èô§");
        loadData();
      } catch (error) {
        console.error("ÊâπÈáèÂà†Èô§ÈîôËØØ:", error);
        alert("‚ùå Âà™Èô§Â§±Êïó: " + error.message);
      }
    }
  
    // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
    document.addEventListener('DOMContentLoaded', () => {
      // Á°Æ‰øùDOMÂ∑≤Âä†ËΩΩ
      if (!productList) {
        console.error("Êó†Ê≥ïÊâæÂà∞ productList ÂÖÉÁ¥†");
        return;
      }
      
      // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
      document.getElementById('addProductBtn')?.addEventListener('click', addProduct);
      document.getElementById('deleteAllBtn')?.addEventListener('click', deleteAllRecords);
      
      // Âä†ËΩΩÊï∞ÊçÆ
      loadData();
    });
  </script>

</body>
</html>
